!function(){"use strict";window.addEventListener("load",function(){var e=window.document.getElementById("isEu");e.addEventListener("click",function(){window.excelFormulaUtilities.isEu=e.checked})});var e=new Clipboard("#copyFormulaBtn",{text:function(e){return document.getElementById("fomatFormula_2_out").innerHtml}});e.on("success",function(e){e.clearSelection()}),e.on("error",function(e){})}(),function(e,t){"use strict";function a(e){return e.replace(/</gi,"&lt;").replace(/>/gi,"&gt;")}e.excelFormulaBeautifier=e.excelFormulaBeautifier||{},e.excelFormulaBeautifier.examples=e.excelFormulaBeautifier.examples||{};var u={INPUT_ID:"formula_input",FORMULA_TITLE_ID:"fomatFormula_2",FORMULA_BODY_ID:"fomatFormula_2_out",DEFAULT_FORMULA:""},n=null,i="beautify",r=e.excelFormulaBeautifier.examples.beautifier=function(){var t;return{formula:'=IF(SUM( IF(FOO = BAR, 10, 0), 10 ) = 20 , "FOO", "BAR")',input:null,formulaTitle:null,formulaBody:null,mode:"beautify",changeMode:function(t){i=t,e.excelFormulaBeautifier.examples.beautifier.mode=t,e.excelFormulaBeautifier.examples.beautifier.update.call(e.excelFormulaBeautifier.examples.beautifier),"undefined"!=typeof _gaq&&null!==_gaq&&_gaq.push(["_trackEvent","Change Mode","Select",t])},formulaAreaClicked:function(){"undefined"!=typeof _gaq&&null!==_gaq&&_gaq.push(["_trackEvent","Formula Input","Clicked",i])},update:function(){if(this.formula=this.input.value,t!==this.formula){var u=document.getElementById("numberOfSpaces").value||4;u=Number.isNaN(Number.parseInt(u))?4:Math.min(u,10),document.getElementById("numberOfSpaces").value=u;try{switch(this.mode){case"beautify":for(var r="",l=0;l<u;l+=1)r+="&nbsp;";var o={tmplIndentTab:'<span class="tabbed">'+r+"</span>"};this.formulaBody.innerHTML=e.excelFormulaUtilities.formatFormulaHTML(this.formula,o);break;case"minify":this.formulaBody.innerHTML=a(this.formula.replace(/\s+/gi," "));break;case"js":this.formulaBody.innerHTML=a(e.excelFormulaUtilities.formula2JavaScript(this.formula));break;case"csharp":this.formulaBody.innerHTML=a(e.excelFormulaUtilities.formula2CSharp(this.formula));break;case"python":this.formulaBody.innerHTML=a(e.excelFormulaUtilities.formula2Python(this.formula))}}catch(m){}clearTimeout(n),n=setTimeout(function(){"undefined"!=typeof _gaq&&null!==_gaq&&_gaq.push(["_trackEvent","Formula Input","Updated",i])},1e3)}}}}();e.onload=function(){r.input=document.getElementById(u.INPUT_ID),r.formulaBody=document.getElementById(u.FORMULA_BODY_ID),r.input.value=r.formula,r.update();var e=new XMLHttpRequest;e.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var t=document.getElementById("version");t.innerHTML=JSON.parse(e.responseText).version}},e.open("GET","package.json",!0),e.send()}}(window);